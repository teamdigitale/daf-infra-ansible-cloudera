{
    "name": "daf-dev-cm-secure-01",
    "managerVirtualInstance": {
        "id": "9106cf26-919c-4d49-a974-035c927cfe34",
        "template": {
            "name": "basic-node-template",
            "type": "STANDARD_DS12_V2",
            "image": "cloudera-centos-75-latest",
            "rackId": "/default",
            "bootstrapScripts": [
                {
                    "env": null,
                    "content": "#!/bin/sh\n\n# Install prerequisites\nyum install -y https://centos7.iuscommunity.org/ius-release.rpm epel-release\nyum -y update\nyum install -y git2u ansible\n\n# Clone daf-infra-ansible-cloudera repository\nrm -rf daf-infra-cloudera-bootstrap\nGIT_SSH_COMMAND=\"ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no\" git clone https://github.com/teamdigitale/daf-infra-cloudera-bootstrap.git\n\npushd daf-infra-cloudera-bootstrap\n\nansible-playbook bootstrap.yml -i inventory/hosts-dev.yml\n"
                }
            ],
            "preTerminateScripts": [],
            "config": {
                "dataDiskSize": "100",
                "virtualNetworkResourceGroup": "daf-dev-rg",
                "automatic": "false",
                "publicIP": "No",
                "dataDiskCount": "3",
                "subnetName": "daf-dev-subnet-cloudera",
                "virtualNetwork": "daf-dev-vnet-cloudera",
                "computeResourceGroup": "daf-dev-rg",
                "instanceNamePrefix": "devcm",
                "storageAccountType": "Standard_LRS",
                "useCustomManagedImage": "No",
                "networkSecurityGroupResourceGroup": "daf-dev-rg",
                "networkSecurityGroup": "daf-dev-sg-cloudera"
            },
            "tags": null,
            "normalizeInstance": true,
            "sshUsername": "teamdigitale",
            "sshHostKeyRetrievalType": "NONE"
        }
    },
    "externalDatabaseTemplates": {
        "CLOUDERA_MANAGER": {
            "name": "scmt",
            "databaseServerName": "altus-mysql-dev",
            "databaseNamePrefix": "scm",
            "usernamePrefix": "scmu"
        },
        "ACTIVITYMONITOR": {
            "name": "amont",
            "databaseServerName": "altus-mysql-dev",
            "databaseNamePrefix": "amon",
            "usernamePrefix": "amonu"
        },
        "REPORTSMANAGER": {
            "name": "rmant",
            "databaseServerName": "altus-mysql-dev",
            "databaseNamePrefix": "rman",
            "usernamePrefix": "rmanu"
        },
        "NAVIGATOR": {
            "name": "navt",
            "databaseServerName": "altus-mysql-dev",
            "databaseNamePrefix": "nav",
            "usernamePrefix": "navu"
        },
        "NAVIGATORMETASERVER": {
            "name": "navmst",
            "databaseServerName": "altus-mysql-dev",
            "databaseNamePrefix": "navms",
            "usernamePrefix": "navmsu"
        }
    },
    "configs": {
        "CLOUDERA_MANAGER": {
            "custom_banner_html": "Managed by Cloudera Altus Director. DEV environment",
            "kdc_type": "MIT KDC",
            "security_realm": "CLOUDERA.DEV.DAF.TEAMDIGITALE.INTERNAL",
            "kdc_host": "kerberos-01.mgmt.dev.daf.teamdigitale.internal",
            "kdc_admin_host": "kerberos-01.mgmt.dev.daf.teamdigitale.internal",
            "krb_realms_safety_valve": "kdc = kerberos-02.mgmt.dev.daf.teamdigitale.internal",
            "krb_domain": "cloudera.dev.daf.teamdigitale.internal",
            "krb_enc_types": "aes256-cts aes128-cts arcfour-hmac",
            "krb_manage_krb5_conf": true,
            "auth_backend_order": "LDAP_ONLY",
            "ldap_type": "LDAP",
            "ldap_url": "ldaps://freeipa-master-01.mgmt.dev.daf.teamdigitale.internal",
            "ldap_dn_pattern": "uid={0},cn=users,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "ldap_bind_dn": "uid=admin,cn=users,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "ldap_bind_pw": "REDACTED",
            "ldap_user_search_base": "cn=users,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "ldap_user_search_filter": "(objectclass=posixaccount)",
            "ldap_group_search_base": "cn=groups,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "ldap_group_search_filter": "(objectclass=posixgroup)"
        },
        "CLOUDERA_MANAGEMENT_SERVICE": {
            "enable_alerts" : true,
            "enable_config_alerts" : true
        },
        "SERVICEMONITOR": {
            "mgmt_log_dir": "/data0/log/cloudera-scm-firehose",
            "firehose_storage_dir": "/data0/lib/cloudera-service-monitor",
            "firehose_heapsize": "2147483648",
            "firehose_non_java_memory_bytes": "12884901888"
        },
        "ACTIVITYMONITOR": {
            "mgmt_log_dir": "/data0/log/cloudera-scm-firehose"
        },
        "HOSTMONITOR": {
            "mgmt_log_dir": "/data0/log/cloudera-scm-firehose",
            "firehose_storage_dir": "/data0/lib/cloudera-host-monitor",
            "firehose_heapsize": "2147483648",
            "firehose_non_java_memory_bytes": "2147483648"
        },
        "REPORTSMANAGER": {
            "headlamp_scratch_dir": "/data0/lib/cloudera-scm-headlamp",
            "mgmt_log_dir": "/data0/log/cloudera-scm-headlamp"
        },
        "EVENTSERVER": {
            "mgmt_log_dir": "/data0/log/cloudera-scm-eventserver",
            "eventserver_index_dir": "/data0/lib/cloudera-scm-eventserver"
        },
        "ALERTPUBLISHER": {
            "mgmt_log_dir": "/data0/log/cloudera-scm-alertpublisher",
            "alert_mailserver_enabled": "false",
            "alert_mailserver_hostname": "smtp.gmail.com",
            "alert_mailserver_username": "daf.technical@gmail.com",
            "alert_mailserver_password": "REDACTED",
            "alert_mailserver_from_address": "noreply.azure@daf.technical.local",
            "alert_mailserver_recipients": "gruggiero@teamdigitale.governo.it"
        },
        "NAVIGATOR": {
            "mgmt_log_dir": "/data0/log/cloudera-scm-navigator"
        },
        "NAVIGATORMETASERVER": {
            "audit_event_log_dir": "/data0/log/cloudera-scm-navigator/audit",
            "data_dir": "/data0/lib/cloudera-scm-navigator",
            "mgmt_log_dir": "/data0/log/cloudera-scm-navigator",
            "auth_backend_order": "CM_THEN_EXTERNAL",
            "nav_ldap_url": "ldaps://freeipa-master-01.mgmt.dev.daf.teamdigitale.internal ldaps://freeipa-replica-01.mgmt.dev.daf.teamdigitale.internal ldaps://freeipa-replica-02.mgmt.dev.daf.teamdigitale.internal",
            "nav_ldap_bind_dn": "uid=admin,cn=users,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "nav_ldap_bind_pw": "REDACTED",
            "nav_ldap_user_search_base": "cn=users,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "nav_ldap_dn_pattern": "uid={0},cn=users,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "nav_ldap_group_search_base": "cn=groups,cn=accounts,dc=mgmt,dc=dev,dc=daf,dc=teamdigitale,dc=internal",
            "nav_ldap_user_search_filter": "(objectclass=posixaccount)",
            "nav_ldap_group_search_filter": "(&(objectClass=posixgroup)(member={0}))",
            "nav_ldap_groups_search_filter": "(&(objectClass=posixgroup)(cn=*{0}*))"
        },
        "HOSTS": {
          "memory_overcommit_threshold": "0.9"
        }
    },
    "repository": "https://archive.cloudera.com/cm6/6.2.0/redhat7/yum",
    "repositoryKeyUrl": "https://archive.cloudera.com/cm6/6.2/redhat7/yum/RPM-GPG-KEY-cloudera",
    "tlsEnabled": "true",
    "tlsConfigurationProperties": {
      "ca_key_args": "4096",
      "host_key_args": "4096",
      "ca_expiration": "240619",
      "host_expiration": "240619",
      "trusted_ca_certs": "/etc/ipa/ca.crt"
    },
    "krbAdminUsername": "cloudera/admin@CLOUDERA.DEV.DAF.TEAMDIGITALE.INTERNAL",
    "krbAdminPassword": "REDACTED",
    "cmVersion": "6.2.0",
    "enableEnterpriseTrial": true,
    "javaInstallationStrategy": "AUTO",
    "unlimitedJce": "true",
    "csds": [
      "http://archive.cloudera.com/spark2/csd/SPARK2_ON_YARN-2.2.0.cloudera4.jar",
      "http://archive.cloudera.com/CFM/csd/1.0.0.0/NIFI-1.9.0.1.0.0.0-90.jar"
    ],
    "postCreateScripts": [
      {
          "env": null,
          "content": "# TODO: set -Djavax.net.ssl.trustStore=/var/lib/cloudera-scm-server/certmanager/trust-store/cm-auto-global_truststore.jks in /etc/defaults/cloudera-scm-server\nsystemctl restart cloudera-scm-server"
      }
    ]
}
