---

- name: Ansible for bootstrap playbook for Cloudera instances
  hosts: 127.0.0.1
  connection: local
  become: yes
  become_method: sudo
  gather_facts: yes

  tasks:
    - name: Disable /etc/resolv.conf overwrites by NetworkManager
      lineinfile:
        dest: /etc/NetworkManager/NetworkManager.conf
        regexp: "^dns="
        line: "dns=none"
        insertafter: "^[main]"
        state: present
    - name: Add search domain to /etc/resolv.conf
      lineinfile:
        dest: /etc/resolv.conf
        regexp: "search"
        line: "search cloudera.{{ current_environment }}.daf.teamdigitale.internal"
        state: present
